<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>サポート ライブラリのできるまで</title>
    <style>
      @import url(http://fonts.googleapis.com/earlyaccess/notosansjapanese.css);

      body {
        font-family: 'Noto Sans Japanese', sans-serif;
      }

      a {
        text-decoration: none;
        color: blue;
      }

      a:visited {
        color: blue;
      }

      a:hover {
        text-decoration: underline;
      }

      li {
        line-height: 1.8;
      }

      h1, h2, h3 {
        font-family: 'Noto Sans Japanese', sans-serif;
        font-weight: bold;
      }

      .chapter-1.normal {
        background-image: linear-gradient(180deg, #3F51B5 50%, #FFFFFF 50%);
      }

      .chapter-1.hero {
        background-color: #3F51B5;
      }

      .chapter-2.normal {
        background-image: linear-gradient(180deg, #F44336 50%, #FFFFFF 50%);
      }

      .chapter-2.hero {
        background-color: #F44336;
      }

      .chapter-3.normal {
        background-image: linear-gradient(180deg, #009688 50%, #FFFFFF 50%);
      }

      .chapter-3.hero {
        background-color: #009688;
      }

      .chapter-4.normal {
        background-image: linear-gradient(180deg, #E91E63 50%, #FFFFFF 50%);
      }

      .chapter-4.hero {
        background-color: #E91E63;
      }

      .chapter-5.normal {
        background-image: linear-gradient(180deg, #FF5722 50%, #FFFFFF 50%);
      }

      .chapter-5.hero {
        background-color: #FF5722;
      }

      /* ページ番号 */
      .remark-slide-number {
        color: #CCCCCC;
        font-size: 12pt;
        opacity: 1;
      }

      .hero h1 {
        color: #FFFFFF;
      }

      .normal {
        background-position: right 0em bottom 8em;
      }

      .normal h1 {
        color: white;
        margin-top: 0px;
        margin-left: 1em;
        font-size: 28pt;
      }

      .normal h2 {
        margin: 0px;
        font-size: 18pt;
      }

      .remark-code, .remark-inline-code {
        font-family: monospace;
      }

      code {
        border-radius: 4px;
      }

      .hljs-googlecode .hljs {
        background-color: #EEEEEE;
      }

      .card {
        background-color: white;
        border-radius: 0.1em;
        padding: 1em 2em;
        box-shadow: 0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23);
      }

      .card img {
        float: right;
        max-width: 32%;
        max-height: 32%;
      }

    </style>
  </head>
  <body>
    <textarea id="source">

class: center, middle, hero, chapter-1

# <nobr>サポート ライブラリの<wbr>できるまで</nobr>

---

class: normal, chapter-1

# 自己紹介

.card[
![近影](../images/yaraki.png)

荒木佑一

[@yuichi_araki](https://twitter.com/yuichi_araki)

Developer Program Engineer

- Google I/O アプリ
- Google サンタトラッカー
- [d.android.com/samples](http://d.android.com/samples) のサンプル
  - MIDI 関連
  - Camera2 関連
  - Android for Work 関連
  - ScreenCapture
  - Transition 関連
]

---

class: center, middle, hero, chapter-1

# <nobr>Android Design <wbr>Support Library</nobr>

---

class: normal, chapter-1

# それは何

.card[
![cheesesquare](cheesesquare.png)

Material Design のコンポーネント群

- FloatingActionButton
- Snackbar
- CoordinatorLayout
- AppBar
- CollapsingToolbarLayout
- TextInputLayout
- TabLayout
- NavigationView

サンプル: [github.com/chrisbanes/cheesesquare](https://github.com/chrisbanes/cheesesquare)
]

---

class: normal, chapter-1

# 使い方

.card[
Android Design Support Library について  
http://googledevjp.blogspot.jp/2015/07/android-design-support-library.html

Android サポート ライブラリ 23.1 のご紹介  
http://googledevjp.blogspot.jp/2015/11/android-231.html

Techbooster Android Masters!  
https://techbooster.booth.pm/items/126263
]

???

その他インターネットで検索するとたくさん見つかります

今回は使い方の話は最低限にとどめて、この Design サポート ライブラリができるまでの話をします

---

class: normal, chapter-1

# 歴史

.card[
- 2014/06: Google I/O 2014  
  [Material Design を発表](https://www.youtube.com/watch?v=Q8TXgCzxEnw)
- 2014/10: Android 5.0 Lollipop リリース
- 2014/12: 企画開始
- 2015/01: 開発開始
- 2015/05: Google I/O 2015  
  Design Support Library をリリース (バージョン 22.2.0)
- 2015/07: バージョン 22.2.1
- 2015/08: バージョン 23.0.0
- 2015/09: バージョン 23.0.1
- 2015/10: バージョン 23.1.0
- 2015/11: バージョン 23.1.1
]

???

- I/O 2014 アプリ
  - 非マテリアル版とマテリアル版の 2 種類ありました
  - Design ライブラリはありませんでした
- I/O 2015 アプリ
  - Design ライブラリをつかった最初のアプリ

バージョン番号
- 1 つ目はフレームワークの最新 API レベル
- 2 つ目はライブラリの API が変更されたときにあげられる
- 3 つ目は (基本的に) API 変更を伴わないバグフィックス、改善

---

class: normal, chapter-1

# 立ち位置

.card[
## Support v4
- v4 以降に追加された API のバックポート
- リソースなし

## AppCompat
- v7 以降に追加された UI 関係の API のバックポート
- リソースあり
- Support v4 に依存

## Design
- プラットフォームにはない
- AppCompat v7 と RecyclerView に依存
]

???

なぜ既存のライブラリに機能を追加するのではなく、新規にライブラリを作成したか

どこに何があるかわからなくなったときの参考に

RecyclerView には 23.1.0 から依存するようになりました

---

class: center, middle, hero, chapter-2

# 23.1.0, 23.1.1 の変更点

---

class: normal, chapter-2

# AppBar の layout_scrollFlags で snap

.card[
AppBar 内の要素が部分的に表示されている状態を避ける

```xml
<android.support.design.widget.CoordinatorLayout ... >

    <android.support.design.widget.AppBarLayout ... >

        <android.support.v7.widget.Toolbar
            android:id="@+id/toolbar"
            android:layout_width="match_parent"
            android:layout_height="?attr/actionBarSize"
            android:background="?attr/colorPrimary"
            app:popupTheme="@style/ThemeOverlay.AppCompat.Light"
            `app:layout_scrollFlags="scroll|enterAlways|snap"` />

...
```
]

???

- 例は cheesesquare から

---

class: normal, chapter-2

# TextInputLayout の文字数カウンター

.card[
![TextInputLayout スクリーンショット](til-counter.png)

自動的に入力文字数をカウントする

```xml
<android.support.design.widget.TextInputLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        `app:counterEnabled="true"`
        `app:counterMaxLength="30"`>

    <EditText
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:hint="@string/description"/>

</android.support.design.widget.TextInputLayout>
```

- TextView の android:maxLength と違って、制限数を超えて入力できる
]

???

- Java から使うなら setCounterEnabled, setCounterMaxLength
- エラー表示とも共存できる
- https://twitter.com/yanzm/status/638543443745181696

---

class: normal, chapter-2

# NavigationView の app:actionLayout

.card[
![NavigationView スクリーンショット](nv-actionlayout.png)

NavigationView の項目の右端に任意のレイアウトを配置する

```xml
<menu ...>
  <group android:checkableBehavior="single">
    ...
    <item
      android:id="@+id/navigation_item_3"
      android:icon="@drawable/ic_android"
      android:title="@string/navigation_item_3"
      `app:actionLayout="@layout/action_layout"`/>
...
```

- MenuItem#getActionView() で参照を取得
]

???

- Gmail の未読数など

---

class: normal chapter-2

# その他

.card[
- NavigationView の getHeaderView (23.1.1)  
  XML の app:headerLayout で指定したヘッダーを getHeaderView で取得できる
- バグフィックス
]

---

class: center, middle, hero, chapter-3

# カスタム View の作り方

---

class: normal, chapter-3

# 基本

.card[
```java

```
]

---

class: normal, chapter-3

# アノテーション

.card[
]

---

class: center, middle, hero, chapter-4

# パフォーマンス

---

class: normal, chapter-4

# enum を使わない

---

class: normal, chapter-4

# メンバー変数を書き換え過ぎない

.card[
こうじゃなくて

```java
    private int mSomething;

    private void doSomething() {
        for (int i = 0; i < 1000; i++) {
            mSomething += getSomeValue(i);
        }
    }
```

こう

```java
    private void doSomething() {
        int something = mSomething;
        for (int i = 0; i < 1000; i++) {
            something += getSomeValue(i);
        }
        mSomething = something;
    }
```
]

---

class: normal, chapter-5

# サンプル

.card[
これが Java の Hello, world! です。

```java
   public static void main(String[] args) {
       System.out.println("Hello, world!");
   }
```

画面に "Hello, world!" と表示されます。
]

    </textarea>
    <script src="https://gnab.github.io/remark/downloads/remark-latest.min.js">
    </script>
    <script>
      var hljs = remark.highlighter.engine;
    </script>
    <script src="http://gnab.github.io/remark/remark.language.js"></script>
    <script>
      var slideshow = remark.create({
        highlightStyle: 'googlecode',
        highlightLanguage: 'remark',
        highlightLines: true,
        highlightSpans: true
      }) ;
    </script>
  </body>
</html>
